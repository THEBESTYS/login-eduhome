<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¡œê·¸ì¸ | íšŒì›ê°€ì…</title>
    
    <!-- Firebase SDK v9 (í˜¸í™˜ì„± ëª¨ë“œ) -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    
    <style>
        /* ê³¨ë“œ/ì‹¤ë²„ ë¬´ì±„ìƒ‰ ë””ìì¸ ì‹œìŠ¤í…œ */
        :root {
            --white: #ffffff;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --gold-light: #f5e8c6;
            --gold: #d4af37;
            --gold-dark: #b8941f;
            --silver-light: #e8e8e8;
            --silver: #c0c0c0;
            --silver-dark: #a0a0a0;
            --success: #10b981;
            --danger: #ef4444;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-size: 110%; /* ì „ì²´ í°íŠ¸ í¬ê¸° 10% ì¦ê°€ */
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, var(--gray-100) 0%, var(--gray-200) 100%);
            color: var(--gray-800);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            font-size: 110%; /* ë°”ë”” í°íŠ¸ í¬ê¸° ì¦ê°€ */
        }
        
        .auth-container {
            width: 100%;
            max-width: 528px; /* 480pxì˜ 110% */
            background: var(--white);
            border-radius: 18px; /* ì•½ê°„ ì¦ê°€ */
            box-shadow: 0 12px 28px rgba(0, 0, 0, 0.15); /* ê·¸ë¦¼ì ê°•í™” */
            overflow: hidden;
            animation: fadeIn 0.5s ease-out;
            transform: scale(1.1); /* ì „ì²´ ì»¨í…Œì´ë„ˆ í¬ê¸° 10% ì¦ê°€ */
            transform-origin: center center;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px) scale(1.1); }
            to { opacity: 1; transform: translateY(0) scale(1.1); }
        }
        
        .tabs {
            display: flex;
            background: var(--gray-50);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .tab-button {
            flex: 1;
            padding: 22px 0; /* íŒ¨ë”© ì¦ê°€ */
            background: none;
            border: none;
            font-size: 18.7px; /* 17pxì˜ 110% */
            font-weight: 500;
            color: var(--gray-600);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .tab-button:hover {
            color: var(--gray-800);
            background: var(--gray-100);
        }
        
        .tab-button.active {
            color: var(--gold-dark);
            font-weight: 600;
        }
        
        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 25%;
            right: 25%;
            height: 3px;
            background: var(--gold);
            border-radius: 3px 3px 0 0;
        }
        
        .form-panel {
            padding: 44px; /* 40pxì˜ 110% */
            display: none;
        }
        
        .form-panel.active {
            display: block;
            animation: slideIn 0.4s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .form-title {
            font-size: 26.4px; /* 24pxì˜ 110% */
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 35px; /* 32pxì˜ 110% */
            text-align: center;
        }
        
        .form-subtitle {
            font-size: 15.4px; /* 14pxì˜ 110% */
            color: var(--gray-500);
            text-align: center;
            margin-bottom: 35px; /* 32pxì˜ 110% */
        }
        
        .input-group {
            margin-bottom: 24.2px; /* 22pxì˜ 110% */
        }
        
        .input-label {
            display: block;
            font-size: 16.5px; /* 15pxì˜ 110% */
            font-weight: 500;
            color: var(--gray-700);
            margin-bottom: 8.8px; /* 8pxì˜ 110% */
        }
        
        .input-label.required::after {
            content: ' *';
            color: var(--danger);
        }
        
        .input-field {
            width: 100%;
            padding: 15.4px 17.6px; /* 14px 16pxì˜ 110% */
            font-size: 16.5px; /* 15pxì˜ 110% */
            border: 2px solid var(--gray-300);
            border-radius: 11px; /* 10pxì˜ 110% */
            background: var(--white);
            color: var(--gray-800);
            transition: all 0.3s ease;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.15); /* ê³¨ë“œ ìƒ‰ìƒ ì ìš© */
        }
        
        .input-field.error {
            border-color: var(--danger);
        }
        
        .input-field.success {
            border-color: var(--success);
        }
        
        .input-field::placeholder {
            color: var(--gray-400);
        }
        
        .field-note {
            display: block;
            font-size: 14.3px; /* 13pxì˜ 110% */
            color: var(--gray-500);
            margin-top: 6.6px; /* 6pxì˜ 110% */
            line-height: 1.4;
        }
        
        .field-error {
            display: block;
            font-size: 14.3px; /* 13pxì˜ 110% */
            color: var(--danger);
            margin-top: 6.6px; /* 6pxì˜ 110% */
            display: none;
        }
        
        .submit-button {
            width: 100%;
            padding: 17.6px; /* 16pxì˜ 110% */
            background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%); /* ê³¨ë“œ ê·¸ë¼ë°ì´ì…˜ */
            color: var(--white);
            border: none;
            border-radius: 11px; /* 10pxì˜ 110% */
            font-size: 17.6px; /* 16pxì˜ 110% */
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 11px; /* 10pxì˜ 110% */
        }
        
        .submit-button:hover {
            background: linear-gradient(135deg, var(--gold-dark) 0%, #a67c00 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3); /* ê³¨ë“œ ìƒ‰ìƒ ì ìš© */
        }
        
        .submit-button:active {
            transform: translateY(0);
        }
        
        .submit-button.loading {
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        .divider {
            display: flex;
            align-items: center;
            margin: 35px 0; /* 32pxì˜ 110% */
            color: var(--gray-400);
            font-size: 15.4px; /* 14pxì˜ 110% */
        }
        
        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--gray-200);
        }
        
        .divider span {
            padding: 0 17.6px; /* 16pxì˜ 110% */
            background: var(--white);
        }
        
        .links {
            text-align: center;
            margin-top: 30.8px; /* 28pxì˜ 110% */
            font-size: 15.4px; /* 14pxì˜ 110% */
            color: var(--gray-600);
        }
        
        .links a {
            color: var(--gold-dark);
            text-decoration: none;
            margin: 0 13.2px; /* 12pxì˜ 110% */
            transition: color 0.3s ease;
            font-weight: 500;
        }
        
        .links a:hover {
            color: var(--gold);
            text-decoration: underline;
        }
        
        .checkbox-group {
            margin-bottom: 22px; /* 20pxì˜ 110% */
        }
        
        .checkbox-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15.4px; /* 14pxì˜ 110% */
        }
        
        .checkbox-input {
            margin-top: 3.3px; /* 3pxì˜ 110% */
            margin-right: 15.4px; /* 14pxì˜ 110% */
            width: 22px; /* 20pxì˜ 110% */
            height: 22px; /* 20pxì˜ 110% */
            accent-color: var(--gold);
            cursor: pointer;
        }
        
        .checkbox-label {
            font-size: 16.5px; /* 15pxì˜ 110% */
            color: var(--gray-700);
            line-height: 1.5;
            cursor: pointer;
        }
        
        .checkbox-label a {
            color: var(--gold-dark);
            text-decoration: none;
        }
        
        .checkbox-label a:hover {
            text-decoration: underline;
        }
        
        .checkbox-label strong {
            font-weight: 600;
            color: var(--gray-900);
        }
        
        .terms-section {
            background: var(--gray-50);
            border: 2px solid var(--gray-200);
            border-radius: 13.2px; /* 12pxì˜ 110% */
            padding: 26.4px; /* 24pxì˜ 110% */
            margin: 30.8px 0; /* 28pxì˜ 110% */
            max-height: 264px; /* 240pxì˜ 110% */
            overflow-y: auto;
        }
        
        .terms-title {
            font-size: 18.7px; /* 17pxì˜ 110% */
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 19.8px; /* 18pxì˜ 110% */
        }
        
        hr {
            border: none;
            height: 1px;
            background: var(--gray-200);
            margin: 19.8px 0; /* 18pxì˜ 110% */
        }
        
        /* ìƒíƒœ ë©”ì‹œì§€ */
        .status-message {
            padding: 13.2px 17.6px; /* 12px 16pxì˜ 110% */
            border-radius: 8.8px; /* 8pxì˜ 110% */
            margin-bottom: 22px; /* 20pxì˜ 110% */
            font-size: 15.4px; /* 14pxì˜ 110% */
            display: none;
        }
        
        .status-success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
            display: block;
        }
        
        .status-error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
            display: block;
        }
        
        .status-info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #bfdbfe;
            display: block;
        }
        
        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .spinner {
            display: inline-block;
            width: 22px; /* 20pxì˜ 110% */
            height: 22px; /* 20pxì˜ 110% */
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: var(--white);
            animation: spin 1s ease-in-out infinite;
            margin-right: 11px; /* 10pxì˜ 110% */
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @media (max-width: 480px) {
            .auth-container {
                border-radius: 13.2px; /* 12pxì˜ 110% */
                transform: scale(1); /* ëª¨ë°”ì¼ì—ì„œëŠ” ì›ë˜ í¬ê¸° ìœ ì§€ */
            }
            
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
            }
            
            .form-panel {
                padding: 26.4px; /* 24pxì˜ 110% */
            }
            
            .tab-button {
                font-size: 17.6px; /* 16pxì˜ 110% */
                padding: 17.6px 0; /* 16pxì˜ 110% */
            }
            
            .form-title {
                font-size: 24.2px; /* 22pxì˜ 110% */
            }
        }
    </style>
</head>
<body>
    <div class="auth-container">
        <!-- íƒ­ ë©”ë‰´ -->
        <div class="tabs">
            <button class="tab-button active" data-tab="login">ë¡œê·¸ì¸</button>
            <button class="tab-button" data-tab="signup">íšŒì›ê°€ì…</button>
        </div>
        
        <!-- ë¡œê·¸ì¸ í¼ -->
        <div id="login-form" class="form-panel active">
            <h2 class="form-title">ë¡œê·¸ì¸</h2>
            <p class="form-subtitle">ê³„ì •ì´ ì—†ìœ¼ì‹œë‹¤ë©´ íšŒì›ê°€ì…ì„ ì§„í–‰í•´ì£¼ì„¸ìš”</p>
            
            <!-- ìƒíƒœ ë©”ì‹œì§€ -->
            <div id="login-status" class="status-message"></div>
            
            <div class="input-group">
                <label class="input-label required" for="email">ì´ë©”ì¼</label>
                <input type="email" id="email" class="input-field" placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”">
                <div class="field-error" id="email-error"></div>
            </div>
            
            <div class="input-group">
                <label class="input-label required" for="password">ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="password" class="input-field" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                <div class="field-error" id="password-error"></div>
            </div>
            
            <button class="submit-button" id="login-btn">
                ë¡œê·¸ì¸
            </button>
            
            <div class="links">
                <a href="#" id="forgot-password">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a>
                <a href="#" data-tab="signup">íšŒì›ê°€ì…</a>
            </div>
            
            <!-- ê´€ë¦¬ì í˜ì´ì§€ ë§í¬ ì‚­ì œë¨ -->
        </div>
        
        <!-- íšŒì›ê°€ì… í¼ -->
        <div id="signup-form" class="form-panel">
            <h2 class="form-title">íšŒì›ê°€ì…</h2>
            <p class="form-subtitle">ë¹ ë¥´ê³  ê°„í¸í•œ íšŒì›ê°€ì…ìœ¼ë¡œ ë‹¤ì–‘í•œ í˜œíƒì„ ëˆ„ë ¤ë³´ì„¸ìš”</p>
            
            <!-- ìƒíƒœ ë©”ì‹œì§€ -->
            <div id="signup-status" class="status-message"></div>
            
            <div class="input-group">
                <label class="input-label required" for="signup-email">ì´ë©”ì¼</label>
                <input type="email" id="signup-email" class="input-field" placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”">
                <div class="field-error" id="signup-email-error"></div>
            </div>
            
            <div class="input-group">
                <label class="input-label required" for="username">ì´ë¦„</label>
                <input type="text" id="username" class="input-field" placeholder="ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”">
                <div class="field-error" id="username-error"></div>
            </div>
            
            <div class="input-group">
                <label class="input-label" for="phone">í•¸ë“œí° ë²ˆí˜¸</label>
                <input type="tel" id="phone" class="input-field" placeholder="ì˜ˆ) 010-1234-5678">
                <span class="field-note">í•˜ì´í”ˆ(-)ì„ í¬í•¨í•˜ì—¬ ì…ë ¥í•´ì£¼ì„¸ìš”</span>
                <div class="field-error" id="phone-error"></div>
            </div>
            
            <div class="input-group">
                <label class="input-label required" for="signup-password">ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="signup-password" class="input-field" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”">
                <span class="field-note">ì˜ë¬¸, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•œ 8ì ì´ìƒ</span>
                <div class="field-error" id="signup-password-error"></div>
            </div>
            
            <div class="input-group">
                <label class="input-label required" for="confirm-password">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                <input type="password" id="confirm-password" class="input-field" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”">
                <div class="field-error" id="confirm-password-error"></div>
            </div>
            
            <!-- ì•½ê´€ ë™ì˜ -->
            <div class="terms-section">
                <div class="terms-title">ì•½ê´€ ë™ì˜</div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="terms-all" class="checkbox-input">
                    <label for="terms-all" class="checkbox-label"><strong>ëª¨ë“  ì•½ê´€ì— ë™ì˜í•©ë‹ˆë‹¤</strong></label>
                </div>
                
                <hr>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="terms-age" class="checkbox-input term" required>
                    <label for="terms-age" class="checkbox-label">ë§Œ 14ì„¸ ì´ìƒì…ë‹ˆë‹¤. (í•„ìˆ˜)</label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="terms-service" class="checkbox-input term" required>
                    <label for="terms-service" class="checkbox-label">ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€ ë™ì˜ (í•„ìˆ˜) <a href="#" id="view-service-terms">ë³´ê¸°</a></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="terms-privacy" class="checkbox-input term" required>
                    <label for="terms-privacy" class="checkbox-label">ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜ (í•„ìˆ˜) <a href="#" id="view-privacy-terms">ë³´ê¸°</a></label>
                </div>
                
                <div class="checkbox-item">
                    <input type="checkbox" id="terms-marketing" class="checkbox-input term">
                    <label for="terms-marketing" class="checkbox-label">ì´ë²¤íŠ¸ ë° SMS ë§ˆì¼€íŒ… ì •ë³´ ìˆ˜ì‹  ë™ì˜ (ì„ íƒ)</label>
                </div>
            </div>
            
            <button class="submit-button" id="signup-btn">
                íšŒì›ê°€ì…
            </button>
            
            <div class="links">
                ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”? <a href="#" data-tab="login">ë¡œê·¸ì¸</a>
            </div>
            
            <!-- ê´€ë¦¬ì í˜ì´ì§€ ë§í¬ ì‚­ì œë¨ -->
        </div>
    </div>

    <script>
        // ========== Firebase ì„¤ì • ==========
        const firebaseConfig = {
            apiKey: "AIzaSyC1XDqgki7lKMz-EE4ZFzOLmku8EsLI0yI",
            authDomain: "login-57c14.firebaseapp.com",
            projectId: "login-57c14",
            storageBucket: "login-57c14.firebasestorage.app",
            messagingSenderId: "847658526472",
            appId: "1:847658526472:web:05adaddfea3afff8e12ebd"
        };

        // ========== ì „ì—­ ë³€ìˆ˜ ==========
        let auth = null;
        let db = null;
        let firebaseApp = null;

        // ========== Firebase ì´ˆê¸°í™” ==========
        function initializeFirebase() {
            try {
                console.log("ğŸ”¥ Firebase ì´ˆê¸°í™” ì‹œë„...");
                
                // ì´ë¯¸ ì´ˆê¸°í™”ë˜ì—ˆëŠ”ì§€ í™•ì¸
                if (firebase.apps.length > 0) {
                    firebaseApp = firebase.apps[0];
                    console.log("âœ… ì´ë¯¸ ì´ˆê¸°í™”ëœ Firebase ì•± ì‚¬ìš©");
                } else {
                    firebaseApp = firebase.initializeApp(firebaseConfig);
                    console.log("âœ… ìƒˆë¡œìš´ Firebase ì•± ì´ˆê¸°í™” ì„±ê³µ");
                }
                
                auth = firebase.auth();
                db = firebase.firestore();
                
                console.log("âœ… Firebase ì„œë¹„ìŠ¤ ì¤€ë¹„ ì™„ë£Œ");
                console.log("í”„ë¡œì íŠ¸ ID:", firebaseApp.options.projectId);
                console.log("Firestore ìƒíƒœ:", !!db ? "ì¤€ë¹„ë¨" : "ì‹¤íŒ¨");
                
                return true;
            } catch (error) {
                console.error("âŒ Firebase ì´ˆê¸°í™” ì‹¤íŒ¨:", error);
                showStatus('login', 'Firebase ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.', 'error');
                return false;
            }
        }

        // ========== UI í•¨ìˆ˜ë“¤ ==========
        function showStatus(formId, message, type = 'info') {
            const statusEl = document.getElementById(`${formId}-status`);
            if (!statusEl) return;
            
            statusEl.textContent = message;
            statusEl.className = `status-message status-${type}`;
            statusEl.style.display = 'block';
            
            if (type === 'error' || type === 'success') {
                setTimeout(() => {
                    statusEl.style.display = 'none';
                }, 5000);
            }
        }

        function setLoading(buttonId, isLoading) {
            const button = document.getElementById(buttonId);
            if (!button) return;
            
            if (isLoading) {
                button.classList.add('loading');
                button.innerHTML = '<span class="spinner"></span>ì²˜ë¦¬ ì¤‘...';
                button.disabled = true;
            } else {
                button.classList.remove('loading');
                button.innerHTML = buttonId === 'login-btn' ? 'ë¡œê·¸ì¸' : 'íšŒì›ê°€ì…';
                button.disabled = false;
            }
        }

        function showError(fieldId, message) {
            const errorEl = document.getElementById(`${fieldId}-error`);
            if (errorEl) {
                errorEl.textContent = message;
                errorEl.style.display = 'block';
                const inputEl = document.getElementById(fieldId);
                if (inputEl) inputEl.classList.add('error');
            }
        }

        function clearErrors(fieldIds) {
            fieldIds.forEach(fieldId => {
                const errorEl = document.getElementById(`${fieldId}-error`);
                if (errorEl) {
                    errorEl.style.display = 'none';
                }
                const inputEl = document.getElementById(fieldId);
                if (inputEl) inputEl.classList.remove('error');
            });
        }

        function showTab(tabName) {
            // íƒ­ ë²„íŠ¼ í™œì„±í™”
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.tab-button[data-tab="${tabName}"]`).classList.add('active');
            
            // í¼ íŒ¨ë„ í™œì„±í™”
            document.querySelectorAll('.form-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            document.getElementById(`${tabName}-form`).classList.add('active');
            
            // ìƒíƒœ ë©”ì‹œì§€ ì´ˆê¸°í™”
            if (tabName === 'login') {
                document.getElementById('signup-status').style.display = 'none';
                setTimeout(() => document.getElementById('email').focus(), 100);
            } else {
                document.getElementById('login-status').style.display = 'none';
                setTimeout(() => document.getElementById('signup-email').focus(), 100);
            }
        }

        // ========== ìœ íš¨ì„± ê²€ì‚¬ í•¨ìˆ˜ ==========
        function validateEmail(email) {
            const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return regex.test(email);
        }

        function validatePassword(password) {
            return password.length >= 8;
        }

        function validatePhone(phone) {
            if (!phone) return true;
            const regex = /^\d{3}-\d{3,4}-\d{4}$/;
            return regex.test(phone);
        }

        // ========== íšŒì›ê°€ì… ì²˜ë¦¬ ==========
        async function handleSignup() {
            console.log("ğŸ“ íšŒì›ê°€ì… ì‹œì‘");
            
            // ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°
            const email = document.getElementById('signup-email').value.trim();
            const username = document.getElementById('username').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const password = document.getElementById('signup-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            // ìœ íš¨ì„± ê²€ì‚¬
            let hasError = false;
            
            if (!email) {
                showError('signup-email', 'ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                hasError = true;
            } else if (!validateEmail(email)) {
                showError('signup-email', 'ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.');
                hasError = true;
            }
            
            if (!username) {
                showError('username', 'ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                hasError = true;
            }
            
            if (!validatePhone(phone)) {
                showError('phone', 'ì˜¬ë°”ë¥¸ í•¸ë“œí° ë²ˆí˜¸ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. (ì˜ˆ: 010-1234-5678)');
                hasError = true;
            }
            
            if (!password) {
                showError('signup-password', 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                hasError = true;
            } else if (!validatePassword(password)) {
                showError('signup-password', 'ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
                hasError = true;
            }
            
            if (!confirmPassword) {
                showError('confirm-password', 'ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                hasError = true;
            } else if (password !== confirmPassword) {
                showError('confirm-password', 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                hasError = true;
            }
            
            // ì•½ê´€ ë™ì˜ í™•ì¸
            const termsAge = document.getElementById('terms-age').checked;
            const termsService = document.getElementById('terms-service').checked;
            const termsPrivacy = document.getElementById('terms-privacy').checked;
            
            if (!termsAge || !termsService || !termsPrivacy) {
                showStatus('signup', 'í•„ìˆ˜ ì•½ê´€ì— ëª¨ë‘ ë™ì˜í•´ì£¼ì„¸ìš”.', 'error');
                hasError = true;
            }
            
            if (hasError) {
                console.log("âŒ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨");
                return;
            }
            
            // ëª¨ë“  ì—ëŸ¬ ì´ˆê¸°í™”
            clearErrors(['signup-email', 'username', 'phone', 'signup-password', 'confirm-password']);
            setLoading('signup-btn', true);
            
            try {
                console.log('1. Firebase Auth ì‚¬ìš©ì ìƒì„± ì‹œë„:', email);
                
                // 1. Firebase Authì— ì‚¬ìš©ì ìƒì„±
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;
                
                console.log('âœ… 2. Firebase Auth ìƒì„± ì„±ê³µ:', user.uid);
                
                // ë§ˆì¼€íŒ… ë™ì˜ ì—¬ë¶€
                const marketingAgreed = {
                    email: document.getElementById('terms-marketing')?.checked || false,
                    sms: false
                };
                
                // 2. Firestoreì— ì €ì¥í•  ë°ì´í„°
                const userData = {
                    uid: user.uid,
                    email: email,
                    username: username,
                    phone: phone || '',
                    displayName: username,
                    tier: 'bronze',
                    points: 1000,
                    status: 'active',
                    signupMethod: 'email',
                    emailVerified: false,
                    marketingAgreed: marketingAgreed,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
                    lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                };
                
                console.log('3. Firestore ì €ì¥ ì‹œë„:', userData);
                
                // 3. Firestoreì— ì €ì¥
                await db.collection('ashop_users').doc(user.uid).set(userData);
                
                console.log('âœ… 4. Firestore ì €ì¥ ì™„ë£Œ!');
                
                // 4. ì´ë©”ì¼ ì¸ì¦ ë©”ì¼ ë°œì†¡
                await user.sendEmailVerification();
                console.log('ğŸ“§ 5. ì´ë©”ì¼ ì¸ì¦ ë©”ì¼ ë°œì†¡ë¨');
                
                // 5. ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
                showStatus('signup', 
                    `ğŸ‰ ${username}ë‹˜, íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\nê°€ì… ì¶•í•˜ í¬ì¸íŠ¸ 1,000ì ì´ ì§€ê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤.\nì´ë©”ì¼ ì¸ì¦ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.`, 
                    'success'
                );
                
                // 6. í¼ ì´ˆê¸°í™”
                document.getElementById('signup-email').value = '';
                document.getElementById('username').value = '';
                document.getElementById('phone').value = '';
                document.getElementById('signup-password').value = '';
                document.getElementById('confirm-password').value = '';
                document.getElementById('terms-all').checked = false;
                document.querySelectorAll('.term').forEach(term => term.checked = false);
                
                // 7. 3ì´ˆ í›„ ë¡œê·¸ì¸ íƒ­ìœ¼ë¡œ ì „í™˜
                setTimeout(() => {
                    showTab('login');
                    document.getElementById('email').value = email;
                    showStatus('login', `${username}ë‹˜, ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”!`, 'success');
                }, 3000);
                
            } catch (error) {
                console.error('âŒ íšŒì›ê°€ì… ì‹¤íŒ¨:', error);
                
                let errorMessage = 'íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
                
                switch(error.code) {
                    case 'auth/email-already-in-use':
                        errorMessage = 'ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤.';
                        showError('signup-email', errorMessage);
                        break;
                    case 'auth/weak-password':
                        errorMessage = 'ë¹„ë°€ë²ˆí˜¸ê°€ ë„ˆë¬´ ì•½í•©ë‹ˆë‹¤. ë” ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.';
                        showError('signup-password', errorMessage);
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'ìœ íš¨í•˜ì§€ ì•Šì€ ì´ë©”ì¼ í˜•ì‹ì…ë‹ˆë‹¤.';
                        showError('signup-email', errorMessage);
                        break;
                    case 'auth/operation-not-allowed':
                        errorMessage = 'ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ íšŒì›ê°€ì…ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.';
                        showStatus('signup', errorMessage, 'error');
                        break;
                    case 'permission-denied':
                        errorMessage = 'ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.';
                        showStatus('signup', errorMessage, 'error');
                        break;
                    default:
                        showStatus('signup', `${errorMessage}: ${error.message}`, 'error');
                }
                
            } finally {
                setLoading('signup-btn', false);
            }
        }

        // ========== ë¡œê·¸ì¸ ì²˜ë¦¬ ==========
        async function handleLogin() {
            console.log("ğŸ” ë¡œê·¸ì¸ ì‹œì‘");
            
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;
            
            // ìœ íš¨ì„± ê²€ì‚¬
            if (!email) {
                showError('email', 'ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (!validateEmail(email)) {
                showError('email', 'ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.');
                return;
            }
            
            if (!password) {
                showError('password', 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            clearErrors(['email', 'password']);
            setLoading('login-btn', true);
            
            try {
                console.log('ë¡œê·¸ì¸ ì‹œë„:', email);
                
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                const user = userCredential.user;
                
                console.log('âœ… ë¡œê·¸ì¸ ì„±ê³µ:', user.uid);
                
                // ë¡œê·¸ì¸ ì‹œê°„ ì—…ë°ì´íŠ¸
                if (db) {
                    try {
                        await db.collection('ashop_users').doc(user.uid).update({
                            lastLogin: firebase.firestore.FieldValue.serverTimestamp(),
                            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                        console.log('âœ… ë¡œê·¸ì¸ ì‹œê°„ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
                    } catch (updateError) {
                        console.warn('ë¡œê·¸ì¸ ì‹œê°„ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨ (ë¬´ì‹œ ê°€ëŠ¥):', updateError);
                    }
                }
                
                // ì„±ê³µ ë©”ì‹œì§€
                showStatus('login', `${user.email}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!`, 'success');
                
                // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                document.getElementById('email').value = '';
                document.getElementById('password').value = '';
                
                // 2ì´ˆ í›„ í™ˆí˜ì´ì§€ë¡œ ì´ë™
                setTimeout(() => {
                    window.location.href = '../index.html';
                }, 2000);
                
            } catch (error) {
                console.error('âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨:', error);
                
                let errorMessage = 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
                
                switch(error.code) {
                    case 'auth/user-not-found':
                        errorMessage = 'ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì´ë©”ì¼ì…ë‹ˆë‹¤.';
                        showError('email', errorMessage);
                        break;
                    case 'auth/wrong-password':
                        errorMessage = 'ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.';
                        showError('password', errorMessage);
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'ìœ íš¨í•˜ì§€ ì•Šì€ ì´ë©”ì¼ í˜•ì‹ì…ë‹ˆë‹¤.';
                        showError('email', errorMessage);
                        break;
                    case 'auth/user-disabled':
                        errorMessage = 'ì‚¬ìš©ì´ ì¤‘ì§€ëœ ê³„ì •ì…ë‹ˆë‹¤.';
                        showError('email', errorMessage);
                        break;
                    case 'auth/too-many-requests':
                        errorMessage = 'ë„ˆë¬´ ë§ì€ ì‹œë„ê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                        showStatus('login', errorMessage, 'error');
                        break;
                    default:
                        showStatus('login', `${errorMessage}: ${error.message}`, 'error');
                }
                
            } finally {
                setLoading('login-btn', false);
            }
        }

        // ========== ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ==========
        async function handleForgotPassword() {
            const email = prompt('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¬ì„¤ì •í•  ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:');
            
            if (!email) return;
            
            if (!validateEmail(email)) {
                alert('ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                await auth.sendPasswordResetEmail(email);
                alert(`ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë©”ì¼ì„ ${email}ë¡œ ë°œì†¡í–ˆìŠµë‹ˆë‹¤.\nì´ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.`);
            } catch (error) {
                console.error('ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì‹¤íŒ¨:', error);
                alert('ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì´ë©”ì¼ ì£¼ì†Œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
            }
        }

        // ========== ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ==========
        function setupEventListeners() {
            console.log("ğŸ”— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì‹œì‘");
            
            // íƒ­ ë²„íŠ¼
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', () => {
                    const tabName = button.getAttribute('data-tab');
                    showTab(tabName);
                });
            });
            
            // íšŒì›ê°€ì… ë²„íŠ¼
            const signupBtn = document.getElementById('signup-btn');
            if (signupBtn) {
                signupBtn.addEventListener('click', async (e) => {
                    e.preventDefault();
                    console.log("âœ… íšŒì›ê°€ì… ë²„íŠ¼ í´ë¦­ë¨!");
                    await handleSignup();
                });
            }
            
            // ë¡œê·¸ì¸ ë²„íŠ¼
            const loginBtn = document.getElementById('login-btn');
            if (loginBtn) {
                loginBtn.addEventListener('click', async (e) => {
                    e.preventDefault();
                    console.log("âœ… ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­ë¨!");
                    await handleLogin();
                });
            }
            
            // ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°
            const forgotPasswordBtn = document.getElementById('forgot-password');
            if (forgotPasswordBtn) {
                forgotPasswordBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    handleForgotPassword();
                });
            }
            
            // íƒ­ ì „í™˜ ë§í¬
            document.querySelectorAll('a[data-tab]').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const tabName = link.getAttribute('data-tab');
                    showTab(tabName);
                });
            });
            
            // ì•½ê´€ ì „ì²´ ë™ì˜
            const termsAll = document.getElementById('terms-all');
            if (termsAll) {
                termsAll.addEventListener('click', () => {
                    const isChecked = termsAll.checked;
                    document.querySelectorAll('.term').forEach(term => {
                        term.checked = isChecked;
                    });
                });
            }
            
            // ì•½ê´€ ë³´ê¸°
            document.getElementById('view-service-terms')?.addEventListener('click', (e) => {
                e.preventDefault();
                alert('ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...');
            });
            
            document.getElementById('view-privacy-terms')?.addEventListener('click', (e) => {
                e.preventDefault();
                alert('ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ì•½ê´€ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...');
            });
            
            // ì—”í„° í‚¤ë¡œ í¼ ì œì¶œ
            document.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const activePanel = document.querySelector('.form-panel.active');
                    if (activePanel.id === 'login-form') {
                        e.preventDefault();
                        handleLogin();
                    } else if (activePanel.id === 'signup-form') {
                        e.preventDefault();
                        handleSignup();
                    }
                }
            });
            
            console.log("âœ… ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì™„ë£Œ");
        }

        // ========== í˜ì´ì§€ ì´ˆê¸°í™” ==========
        document.addEventListener('DOMContentLoaded', function() {
            console.log("ğŸ“„ DOM ë¡œë“œ ì™„ë£Œ");
            
            // Firebase ì´ˆê¸°í™”
            const firebaseInitialized = initializeFirebase();
            
            if (firebaseInitialized) {
                // 'ì‹œìŠ¤í…œ ì—°ê²°ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤' ë©”ì‹œì§€ ì œê±°ë¨
                // ì¸ì¦ ìƒíƒœ ê°ì‹œ
                auth.onAuthStateChanged((user) => {
                    if (user) {
                        console.log("ğŸ‘¤ í˜„ì¬ ë¡œê·¸ì¸ëœ ì‚¬ìš©ì:", user.email);
                        if (user.emailVerified) {
                            console.log("âœ… ì´ë©”ì¼ ì¸ì¦ ì™„ë£Œë¨");
                        }
                    } else {
                        console.log("ğŸšª ë¡œê·¸ì¸ëœ ì‚¬ìš©ì ì—†ìŒ");
                    }
                });
            }
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            setupEventListeners();
            
            // ë¡œê·¸ì¸ í¼ ì´ë©”ì¼ í•„ë“œì— í¬ì»¤ìŠ¤
            document.getElementById('email').focus();
            
            console.log("âœ… í˜ì´ì§€ ì´ˆê¸°í™” ì™„ë£Œ");
        });
    </script>
</body>
</html>
